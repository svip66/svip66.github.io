<!DOCTYPE html>
<html lang="zh-CN">

<!-- Mirrored from www.519faka.run/jingdian/user/resetpwd.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 05 Dec 2021 10:14:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="UTF-8">
    <title>重置密码</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="Keywords" content="网站关键词">
    <meta name="Description" content="网站介绍">
    <link rel="stylesheet" href="../../static/jingdian/reg/css/base.css">
    <link rel="stylesheet" href="../../static/jingdian/reg/css/iconfont.css">
    <link rel="stylesheet" href="../../static/jingdian/reg/css/reg.css">
     <link href="../../static/admin/css/layui.css" rel="stylesheet">
    
</head>
<body>
	
    <div id="ajax-hook"></div>
    <div class="wrap">
        <div class="wpn">
            <div class="form-data pos">
            	
                <a href="#"><img src="../../static/jingdian/reg/img/resetpwd.png" class="head-logo"></a>
                
                <form action="http://www.519faka.run/jingdian/user/resetpwd.html" method="post" id="doreg">
                    <p class="p-input pos">
                        <label for="mobile">请输入帐号绑定的手机号</label>
                        <input type="text" id="mobile" autocomplete="off" name="mobile">
                        <span class="tel-warn img-err hide"><em></em><i class="icon-succ1" style="color: #1edf79"></i></span>
                    </p>
                    	                <div id="captcha" style="margin: 0 auto 16px;display: block;padding-left: 55px;">
			            <div id="text">
			               	 行为验证™ 安全组件加载中
			            </div>
			            <div id="wait" class="show">
				                <div class="loading">
				                    <div class="loading-dot"></div>
				                    <div class="loading-dot"></div>
				                    <div class="loading-dot"></div>
				                    <div class="loading-dot"></div>
				                </div>
				         </div>
				    </div>
	            	                    <p class="p-input pos" id="sendcode">
                        <label for="veri-code">输入验证码</label>
                        <input type="number" id="smscode" name="smscode">
                        <a href="javascript:;" class="send">发送验证码</a>
                        <span class="time hide"><em>60</em>秒后可重新发送</span>
                        <span class="error hide"><em></em><i class="icon-warn" style="margin-left: 5px"></i></span>
                    </p>
                    
                    
                    
                    <p class="p-input pos" id="pwd">
                        <label for="passport">输入新的密码</label>
                        <input type="password" style="display: none"/>
                        <input type="password" name="password" id="password">
                        <span class="tel-warn pwd-err hide"><em></em><i class="icon-succ1" style="color: #1edf79"></i></span>
                    </p>
                  
                   
                    
                
                
               
                <button class="lang-btn "  id="regbtn" type="submit">重置密码</button>
                </form>
                <div class="bottom-info">已有账号，<a href="index-2.html">马上登录</a></div>
                <div class="third-party">
                    <a href="#" class="log-qq icon-qq-round"></a>
                    <a href="#" class="log-qq icon-weixin"></a>
                    <a href="#" class="log-qq icon-sina1"></a>
                </div>
                <p class="right"><p class="right"> <a href="../../index.html" class="log-qq icon-home">返回首页</a></p></p>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="../../static/admin/js/jquery.min63b9.js?v=2.1.4"></script>
    <script type="text/javascript" src="../../static/admin/js/jquery.form.js"></script>
    <script type="text/javascript" src="../../static/admin/js/lunhui.js"></script>
    <script src="../../static/jingdian/reg/js/agree.js"></script>
    <script type="text/javascript" src="../../static/jingdian/917/Content/layer/layer.js"></script> 
    <script type="text/javascript" src="../../static/jingdian/geetest/js/gt.js"></script> 
    <script type="text/javascript">
		$(".message").click(function(){
			window.location.href='reg-2.html';
     	});
 		$(".account_number").click(function(){
        	window.location.href='reg-2.html';
       	});
		
		function in_array(stringToSearch, arrayToSearch) {
		     for (s = 0; s < arrayToSearch.length; s++) {
		      thisEntry = arrayToSearch[s].toString();
		      if (thisEntry == stringToSearch) {
		       return true;
		      }
		     }
		     return false;
		}
		
		function checkpassword(password){
			var rupsw=["123456","a123456","123456a","5201314","111111","000000","qq123456","123123","qwe123"];
			if(in_array(password,rupsw)){
			    $("#password").next().addClass("hide");
			  	layer.tips(password+'此密码是弱密码不能使用!!', "#password",{time:3000});
			    return false;
			}
			if(password.length<6){
			  
			  	$("#password").next().addClass("hide");
			  	layer.tips('密码长度不能小于6个字符串', "#password",{time:3000});
			    return false;
		  	}
		  	if(password.length>20){
			  	
			  	$("#password").next().addClass("hide");
			  	layer.tips('密码长度不能大于20个字符串', "#password",{time:3000});
			    return false;
		  	}
		  	if(password==''){
		  		
		  		$("#password").next().addClass("hide");
			  	layer.tips('密码不能为空', "#password",{time:3000});
			    return false;
		  	}
		  	var reg = new RegExp("[\\u4E00-\\u9FFF]+","g");
			if(reg.test(password)){
				
				$("#password").next().addClass("hide");
			  	layer.tips('密码不支持汉字，只支持字母、数字(6-20)位', "#password",{time:3000});
			    return false;
			}
			return true;
		}
		//判断手机
		function isPoneAvailable(str) {
            var myreg=/^[1][0-9]{10}$/;
            if (!myreg.test(str)) {
                return false;
            } else {
                return true;
            }
		}
		//判断邮箱
		function fChkMail(szMail){ 
			var szReg=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/; 
			var bChk=szReg.test(szMail); 
			return bChk; 
		}
		//判断QQ
		function isQQ(qq) {
		    qq=qq+"";
		    var reg=/^[1-9]\d{4,12}$/;
		    if (reg.test(qq)){
		        return true;
		    } else{
		        return false;
		    }
		}
		
		
		
		
		
		
		function removeAllSpace(str) {
			return str.replace(/\s+/g, "");
		}
		
		$(function(){
	        $('#doreg').ajaxForm({
	            beforeSubmit: checkForm, // 此方法主要是提交前执行的方法，根据需要设置
	            success: complete, // 这是提交后的方法
	            dataType: 'json'
	        });
	        
	        function checkForm(){
	            var mobile=$("#mobile").val();
				mobile=removeAllSpace(mobile);				
				if(mobile==''){
					layer.tips('手机不能为空', '#mobile',{time:3000});
					return false;
				}
				if(isPoneAvailable(mobile)==false){
					$('#mobile').next().addClass("hide");
					layer.tips('请输入正确的联系手机', '#mobile',{time:3000});
					return false;
				}
				var password=$("#password").val();
				password=removeAllSpace(password);
				if(checkpassword(password)==false){
					return false;
				}
				
				var smscode=$("#smscode").val();
				smscode=removeAllSpace(smscode);
				if(smscode.length<6){
					
				  	layer.tips('手机验证码不正确', '#smscode',{time:3000});
				    return false;
				}								
								var result = publicObj.getValidate();
	            if (!result) {
	            	layer.tips('请先完成验证', '#captcha',{time:1000});
	                return false;
	            }
	            
	            	            $('#regbtn').text('重置中...');
	            $('#regbtn').attr('disabled',true);
	            $('#regbtn').addClass("off");
	        }
	
	
	        function complete(data){
	            if(data.code==1){
	                lunhui.success(data.msg,data.url);
	            }else{ 
	                lunhui.error(data.msg);
	                	                publicObj.reset();
	                	                $('#regbtn').text('重置');
	                $('#regbtn').attr('disabled',false);
	                $('#regbtn').removeClass("off");
	                return false;   
	            }
	        }
	    });
	    
	     $(".form-data").delegate(".send","click",function () {
		   	var mobile=$("#mobile").val();
		   	mobile=removeAllSpace(mobile);
			if(mobile==''){
				layer.tips('手机不能为空', '#mobile',{time:3000});
				return false;
			}
			if(isPoneAvailable(mobile)==false){
				$('#mobile').next().addClass("hide");
				layer.tips('请输入正确的联系手机', '#mobile',{time:3000});
				return false;
			}
							var result = publicObj.getValidate();
	            if (!result) {
	            	layer.tips('请先完成验证', '#captcha',{time:1000});
	                return false;
	            }
	            var geetest_challenge=result.geetest_challenge;
	            var geetest_validate=result.geetest_validate;
	            var geetest_seccode=result.geetest_seccode;
	            var veri;
	            
	        			layer.load(0, {shade: [0.4,'#0f0e0e']});
		   	$.when(sendsms(mobile,veri,geetest_challenge,geetest_validate,geetest_seccode)).done(function (res) {
		   		if(res.code=="OK"){
		   			var oTime = $(".form-data .time"),
					oSend = $(".form-data .send"),
					num = parseInt(oTime.text()),
					oEm = $(".form-data .time em");
					oSend.hide();
					oTime.removeClass("hide");
					var timer = setInterval(function () {
						var num2 = num-=1;
					    oEm.text(num2);
						    if(num2==0){
						        clearInterval(timer);
						        oSend.text("重新发送验证码");
							    oSend.show();
						        oEm.text("60");
						        oTime.addClass("hide");
						    }
				    },1000);
				    layer.closeAll('loading');	
		   		}else{
		   			layer.closeAll('loading');	
		   			layer.alert(res.msg);
		   				                publicObj.reset();
	                		   		}
		   	});
		   	
        });
//发送短信
function sendsms(mobile,code='',geetest_challenge='',geetest_validate='',geetest_seccode=''){
	var defer = $.Deferred();
	$.ajax({
		url: "/jingdian/User/sendMsgResetPwdDo.html",
		type: 'get',
		data: {'mobile': mobile,
				'veri':code,
				'geetest_challenge':geetest_challenge,
				'geetest_validate':geetest_validate,
				'geetest_seccode':geetest_seccode
		},
		async: true,
		dataType: 'json',
		success: function (data) {
			defer.resolve(data);
		}
	});
	return defer;
}

		var publicObj;
	var handler = function (captchaObj) {
        captchaObj.appendTo('#captcha');
        captchaObj.onReady(function () {
            $("#wait").hide();
        });
        publicObj=captchaObj;
        
        
        $('#loginbtn2').click(function () {
            var result = captchaObj.getValidate();
            if (!result) {
                return alert('请完成验证');
            }
            $.ajax({
                url: '/jingdian/geetest/gtcheck',
                type: 'POST',
                dataType: 'json',
                data: {
                    geetest_challenge: result.geetest_challenge,
                    geetest_validate: result.geetest_validate,
                    geetest_seccode: result.geetest_seccode
                },
                success: function (data) {
                    if (data.status === 'success') {
                        alert('登录成功');
                    } else if (data.status === 'fail') {
                        alert('登录失败，请完成验证');
                        captchaObj.reset();
                    }
                }
            });
        })
        // 更多接口说明请参见：http://docs.geetest.com/install/client/web-front/
        window.gt = captchaObj;
    };


    $.ajax({
        url: "/jingdian/geetest/StartCaptchaServlet?t=" + (new Date()).getTime(), // 加随机数防止缓存
        type: "get",
        dataType: "json",
        success: function (data) {
        	$('#text').hide();
            $('#wait').show();

            // 调用 initGeetest 进行初始化
            // 参数1：配置参数
            // 参数2：回调，回调的第一个参数验证码对象，之后可以使用它调用相应的接口
            initGeetest({
                // 以下 4 个配置参数为必须，不能缺少
                gt: data.gt,
                challenge: data.challenge,
                offline: !data.success, // 表示用户后台检测极验服务器是否宕机
                new_captcha: data.new_captcha, // 用于宕机时表示是新验证码的宕机

                product: "float", // 产品形式，包括：float，popup
                width: "343px" 
                
                // 更多配置参数说明请参见：http://docs.geetest.com/install/client/web-front/
            }, handler);
        }
    });
    	</script>
</body>

<!-- Mirrored from www.519faka.run/jingdian/user/resetpwd.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 05 Dec 2021 10:14:31 GMT -->
</html>